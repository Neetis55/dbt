{{ config(
  description = 'POS_FACT view for Sales Analytics Team', 
  materialized = 'view', 
  schema = 'SALES', 
  tags = 'MART_SALES',
  alias = 'POINT_OF_SALES_FACT'
) }} 


SELECT 
    POS.TRANSACTION_KEY,
----------------FK --------------------------------    
    POS.FISCAL_SHIP_DATE_KEY,
    POS.DIRECT_CUSTOMER_KEY,
    POS.INDIRECT_CUSTOMER_KEY,
    POS.END_CUSTOMER_KEY,
    POS.DIRECT_CORPORATION_KEY,
    POS.INDIRECT_CORPORATION_KEY,
    POS.END_CORPORATION_KEY,
    BRIDGE.ADJUSTED_END_CORPORATION_KEY,
    BRIDGE.REFERENCE_CORPORATION_KEY,
    POS.MARKET_PRODUCT_NUMBER_KEY,
    POS.INTERNAL_PART_NUMBER_KEY,
----------------CODE --------------------------------
    POS.TRANSACTION_ID,
    POS.FISCAL_SHIP_DATE,
    POS.DIRECT_CUSTOMER_CODE,
    POS.INDIRECT_CUSTOMER_CODE,
    POS.END_CUSTOMER_CODE,
    POS.DIRECT_CORPORATION_CODE,
    POS.INDIRECT_CORPORATION_CODE,
    POS.END_CORPORATION_CODE,    
    BRIDGE.ADJUSTED_END_CORPORATION_CODE,
    BRIDGE.REFERENCE_CORPORATION_CODE,
    POS.MARKET_PRODUCT_NUMBER,
    POS.INTERNAL_PART_NUMBER,
--------------- OTHER ATTRIBUTES ---------------
    POS.TRANSACTION_CODE,
    POS.REPORTED_SHIP_DATE,
    POS.REPORTED_BRANCH_ID,
    POS.RESALE_QUANTITY,
    POS.DISTRIBUTOR_SHIP_TO_CUSTOMER_IDENTIFIER,
    POS.DISTRIBUTOR_SHIP_TO_CUSTOMER_NAME,
    POS.DISTRIBUTOR_END_CUSTOMER_IDENTIFIER,
    POS.DISTRIBUTOR_END_CUSTOMER_NAME,
    POS.DISTRIBUTOR_INVOICE_NUMBER,
    POS.DISTRIBUTOR_INVOICE_LINE_NUMBER,
    POS.REGISTRATION_NUMBER,
    POS.DEBIT_NUMBER,
    POS.DISTRIBUTOR_PO_NUMBER,
    POS.TRANSACTION_CURRENCY_ISO_CODE,
    POS.RESALE_UNIT_PRICE,
    POS.RESALE_UNIT_PRICE_USD,
    POS.RESALE_NET_AMOUNT,
    POS.RESALE_NET_AMOUNT_USD,
    POS.RESALE_NET_AMOUNT_EUR,
    POS.RESALE_NET_AMOUNT_JPY,
    POS.DISTRIBUTOR_UNIT_PRICE,
    POS.DISTRIBUTOR_UNIT_PRICE_USD,
    POS.DISTRIBUTOR_COST_AMOUNT,
    POS.DISTRIBUTOR_COST_AMOUNT_USD,
    POS.DISTRIBUTOR_COST_AMOUNT_EUR,
    POS.DISTRIBUTOR_COST_AMOUNT_JPY,
    POS.SOURCE_DATA_FROM,
    POS.ONSALES_CREATE_DATE,
    POS.ONSALES_MODIFIED_DATE,
    POS.IS_TRUE_POS,
    POS.IS_SDM_TRUE_POS,
    POS.IS_VAR,
    POS.END_CORPORATION_DECODE,
    POS.BIW_INS_DTTM,
    POS.BIW_UPD_DTTM,
    POS.BIW_BATCH_ID,
    POS.BIW_MD5_KEY 
FROM {{ref('MART_SALES_POINT_OF_SALES_FACT')}} POS 
LEFT JOIN {{ref('MART_SALES_POINT_OF_SALES_CUSTOMER_BRIDGE')}} BRIDGE
    ON POS.TRANSACTION_KEY = BRIDGE.TRANSACTION_KEY
WHERE POS.BIW_LOGICAL_DELETE_FLAG ='N'