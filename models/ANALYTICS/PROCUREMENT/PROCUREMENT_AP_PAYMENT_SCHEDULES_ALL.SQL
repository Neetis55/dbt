
 {{  config (   description = "S2P DATA DISCOVERY VIEW OF AP_PAYMENT_SCHEDULES_ALL ",
     materialized = "view",
     schema = "PROCUREMENT",
     tags = ["PROCUREMENT"],
     alias = "AP_PAYMENT_SCHEDULES_ALL" 
     )  
}} 

SELECT 
INVOICE_ID 
, LAST_UPDATED_BY
, LAST_UPDATE_DATE
, PAYMENT_CROSS_RATE
, PAYMENT_NUM
, AMOUNT_REMAINING
, CREATED_BY
, CREATION_DATE
, DISCOUNT_DATE
, DUE_DATE
, FUTURE_PAY_DUE_DATE
, GROSS_AMOUNT
, HOLD_FLAG
, LAST_UPDATE_LOGIN
, PAYMENT_METHOD_LOOKUP_CODE
, PAYMENT_PRIORITY
, PAYMENT_STATUS_FLAG
, SECOND_DISCOUNT_DATE
, THIRD_DISCOUNT_DATE
, BATCH_ID
, DISCOUNT_AMOUNT_AVAILABLE
, SECOND_DISC_AMT_AVAILABLE
, THIRD_DISC_AMT_AVAILABLE
, ATTRIBUTE1
, ATTRIBUTE10
, ATTRIBUTE11
, ATTRIBUTE12
, ATTRIBUTE13
, ATTRIBUTE14
, ATTRIBUTE15
, ATTRIBUTE2
, ATTRIBUTE3
, ATTRIBUTE4
, ATTRIBUTE5
, ATTRIBUTE6
, ATTRIBUTE7
, ATTRIBUTE8
, ATTRIBUTE9
, ATTRIBUTE_CATEGORY
, DISCOUNT_AMOUNT_REMAINING
, ORG_ID
, GLOBAL_ATTRIBUTE_CATEGORY
, GLOBAL_ATTRIBUTE1
, GLOBAL_ATTRIBUTE2
, GLOBAL_ATTRIBUTE3
, GLOBAL_ATTRIBUTE4
, GLOBAL_ATTRIBUTE5
, GLOBAL_ATTRIBUTE6
, GLOBAL_ATTRIBUTE7
, GLOBAL_ATTRIBUTE8
, GLOBAL_ATTRIBUTE9
, GLOBAL_ATTRIBUTE10
, GLOBAL_ATTRIBUTE11
, GLOBAL_ATTRIBUTE12
, GLOBAL_ATTRIBUTE13
, GLOBAL_ATTRIBUTE14
, GLOBAL_ATTRIBUTE15
, GLOBAL_ATTRIBUTE16
, GLOBAL_ATTRIBUTE17
, GLOBAL_ATTRIBUTE18
, GLOBAL_ATTRIBUTE19
, GLOBAL_ATTRIBUTE20
, EXTERNAL_BANK_ACCOUNT_ID
, INV_CURR_GROSS_AMOUNT
, CHECKRUN_ID
, DBI_EVENTS_COMPLETE_FLAG
, IBY_HOLD_REASON
, PAYMENT_METHOD_CODE
, REMITTANCE_MESSAGE1
, REMITTANCE_MESSAGE2
, REMITTANCE_MESSAGE3
, REMIT_TO_SUPPLIER_NAME
, REMIT_TO_SUPPLIER_ID
, REMIT_TO_SUPPLIER_SITE
, REMIT_TO_SUPPLIER_SITE_ID
, RELATIONSHIP_ID
, BIW_INS_DTTM
, BIW_UPD_DTTM
, BIW_BATCH_ID
FROM {{source("STG_EBS_APPS","AP_PAYMENT_SCHEDULES_ALL")}}    
QUALIFY( ROW_NUMBER() OVER (PARTITION BY INVOICE_ID,PAYMENT_NUM ORDER BY BIW_UPD_DTTM DESC)=1)