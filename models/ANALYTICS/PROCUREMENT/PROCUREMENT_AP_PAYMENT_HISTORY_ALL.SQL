
 {{  config (   
     description = "S2P DATA DISCOVERY VIEW OF AP_PAYMENT_HISTORY_ALL ",    
     materialized = "view",    
     schema = "PROCUREMENT",    
     tags = ["PROCUREMENT"],   
     alias = "AP_PAYMENT_HISTORY_ALL" )  }} 
     
SELECT 
PAYMENT_HISTORY_ID 
, CHECK_ID
, ACCOUNTING_DATE
, TRANSACTION_TYPE
, POSTED_FLAG
, MATCHED_FLAG
, ACCOUNTING_EVENT_ID
, ORG_ID
, CREATION_DATE
, CREATED_BY
, LAST_UPDATE_DATE
, LAST_UPDATED_BY
, LAST_UPDATE_LOGIN
, PROGRAM_UPDATE_DATE
, PROGRAM_APPLICATION_ID
, PROGRAM_ID
, REQUEST_ID
, REV_PMT_HIST_ID
, TRX_BANK_AMOUNT
, ERRORS_BANK_AMOUNT
, CHARGES_BANK_AMOUNT
, TRX_PMT_AMOUNT
, ERRORS_PMT_AMOUNT
, CHARGES_PMT_AMOUNT
, TRX_BASE_AMOUNT
, ERRORS_BASE_AMOUNT
, CHARGES_BASE_AMOUNT
, BANK_CURRENCY_CODE
, BANK_TO_BASE_XRATE_TYPE
, BANK_TO_BASE_XRATE_DATE
, BANK_TO_BASE_XRATE
, PMT_CURRENCY_CODE
, PMT_TO_BASE_XRATE_TYPE
, PMT_TO_BASE_XRATE_DATE
, PMT_TO_BASE_XRATE
, MRC_PMT_TO_BASE_XRATE_TYPE
, MRC_PMT_TO_BASE_XRATE_DATE
, MRC_PMT_TO_BASE_XRATE
, MRC_BANK_TO_BASE_XRATE_TYPE
, MRC_BANK_TO_BASE_XRATE_DATE
, MRC_BANK_TO_BASE_XRATE
, MRC_TRX_BASE_AMOUNT
, MRC_ERRORS_BASE_AMOUNT
, MRC_CHARGES_BASE_AMOUNT
, RELATED_EVENT_ID
, HISTORICAL_FLAG
, INVOICE_ADJUSTMENT_EVENT_ID
, GAIN_LOSS_INDICATOR
, BIW_INS_DTTM
, BIW_UPD_DTTM
, BIW_BATCH_ID
FROM {{source("STG_EBS_APPS","AP_PAYMENT_HISTORY_ALL")}}     
QUALIFY( ROW_NUMBER() OVER (PARTITION BY PAYMENT_HISTORY_ID ORDER BY BIW_UPD_DTTM DESC)=1)