 {{  config (   
     description = "S2P DATA DISCOVERY VIEW OF AP_SUPPLIER_SITES_ALL ",    
     materialized = "view",    
     schema = "PROCUREMENT",    
     tags = ["PROCUREMENT"],   
     alias = "AP_SUPPLIER_SITES_ALL" 
     )  
     }} 

SELECT 
VENDOR_SITE_ID 
, LAST_UPDATE_DATE
, LAST_UPDATED_BY
, VENDOR_ID
, VENDOR_SITE_CODE
, VENDOR_SITE_CODE_ALT
, LAST_UPDATE_LOGIN
, CREATION_DATE
, CREATED_BY
, PURCHASING_SITE_FLAG
, RFQ_ONLY_SITE_FLAG
, PAY_SITE_FLAG
, ATTENTION_AR_FLAG
, ADDRESS_LINE1
, ADDRESS_LINES_ALT
, ADDRESS_LINE2
, ADDRESS_LINE3
, CITY
, STATE
, ZIP
, PROVINCE
, COUNTRY
, AREA_CODE
, PHONE
, CUSTOMER_NUM
, SHIP_TO_LOCATION_ID
, BILL_TO_LOCATION_ID
, SHIP_VIA_LOOKUP_CODE
, FREIGHT_TERMS_LOOKUP_CODE
, FOB_LOOKUP_CODE
, INACTIVE_DATE
, FAX
, FAX_AREA_CODE
, TELEX
, PAYMENT_METHOD_LOOKUP_CODE
, BANK_ACCOUNT_NAME
, BANK_ACCOUNT_NUM
, BANK_NUM
, BANK_ACCOUNT_TYPE
, TERMS_DATE_BASIS
, CURRENT_CATALOG_NUM
, VAT_CODE
, DISTRIBUTION_SET_ID
, ACCTS_PAY_CODE_COMBINATION_ID
, PREPAY_CODE_COMBINATION_ID
, PAY_GROUP_LOOKUP_CODE
, PAYMENT_PRIORITY
, TERMS_ID
, INVOICE_AMOUNT_LIMIT
, PAY_DATE_BASIS_LOOKUP_CODE
, ALWAYS_TAKE_DISC_FLAG
, INVOICE_CURRENCY_CODE
, PAYMENT_CURRENCY_CODE
, HOLD_ALL_PAYMENTS_FLAG
, HOLD_FUTURE_PAYMENTS_FLAG
, HOLD_REASON
, HOLD_UNMATCHED_INVOICES_FLAG
, AP_TAX_ROUNDING_RULE
, AUTO_TAX_CALC_FLAG
, AUTO_TAX_CALC_OVERRIDE
, AMOUNT_INCLUDES_TAX_FLAG
, EXCLUSIVE_PAYMENT_FLAG
, TAX_REPORTING_SITE_FLAG
, ATTRIBUTE_CATEGORY
, ATTRIBUTE1
, ATTRIBUTE2
, ATTRIBUTE3
, ATTRIBUTE4
, ATTRIBUTE5
, ATTRIBUTE6
, ATTRIBUTE7
, ATTRIBUTE8
, ATTRIBUTE9
, ATTRIBUTE10
, ATTRIBUTE11
, ATTRIBUTE12
, ATTRIBUTE13
, ATTRIBUTE14
, ATTRIBUTE15
, REQUEST_ID
, PROGRAM_APPLICATION_ID
, PROGRAM_ID
, PROGRAM_UPDATE_DATE
, VALIDATION_NUMBER
, EXCLUDE_FREIGHT_FROM_DISCOUNT
, VAT_REGISTRATION_NUM
, OFFSET_VAT_CODE
, ORG_ID
, CHECK_DIGITS
, BANK_NUMBER
, ADDRESS_LINE4
, COUNTY
, ADDRESS_STYLE
, LANGUAGE
, ALLOW_AWT_FLAG
, AWT_GROUP_ID
, GLOBAL_ATTRIBUTE1
, GLOBAL_ATTRIBUTE2
, GLOBAL_ATTRIBUTE3
, GLOBAL_ATTRIBUTE4
, GLOBAL_ATTRIBUTE5
, GLOBAL_ATTRIBUTE6
, GLOBAL_ATTRIBUTE7
, GLOBAL_ATTRIBUTE8
, GLOBAL_ATTRIBUTE9
, GLOBAL_ATTRIBUTE10
, GLOBAL_ATTRIBUTE11
, GLOBAL_ATTRIBUTE12
, GLOBAL_ATTRIBUTE13
, GLOBAL_ATTRIBUTE14
, GLOBAL_ATTRIBUTE15
, GLOBAL_ATTRIBUTE16
, GLOBAL_ATTRIBUTE17
, GLOBAL_ATTRIBUTE18
, GLOBAL_ATTRIBUTE19
, GLOBAL_ATTRIBUTE20
, GLOBAL_ATTRIBUTE_CATEGORY
, EDI_TRANSACTION_HANDLING
, EDI_ID_NUMBER
, EDI_PAYMENT_METHOD
, EDI_PAYMENT_FORMAT
, EDI_REMITTANCE_METHOD
, BANK_CHARGE_BEARER
, EDI_REMITTANCE_INSTRUCTION
, BANK_BRANCH_TYPE
, PAY_ON_CODE
, DEFAULT_PAY_SITE_ID
, PAY_ON_RECEIPT_SUMMARY_CODE
, TP_HEADER_ID
, ECE_TP_LOCATION_CODE
, PCARD_SITE_FLAG
, MATCH_OPTION
, COUNTRY_OF_ORIGIN_CODE
, FUTURE_DATED_PAYMENT_CCID
, CREATE_DEBIT_MEMO_FLAG
, OFFSET_TAX_FLAG
, SUPPLIER_NOTIF_METHOD
, EMAIL_ADDRESS
, REMITTANCE_EMAIL
, PRIMARY_PAY_SITE_FLAG
, SHIPPING_CONTROL
, SELLING_COMPANY_IDENTIFIER
, GAPLESS_INV_NUM_FLAG
, DUNS_NUMBER
, TOLERANCE_ID
, LOCATION_ID
, PARTY_SITE_ID
, SERVICES_TOLERANCE_ID
, RETAINAGE_RATE
, TCA_SYNC_STATE
, TCA_SYNC_PROVINCE
, TCA_SYNC_COUNTY
, TCA_SYNC_CITY
, TCA_SYNC_ZIP
, TCA_SYNC_COUNTRY
, PAY_AWT_GROUP_ID
, CAGE_CODE
, LEGAL_BUSINESS_NAME
, DOING_BUS_AS_NAME
, DIVISION_NAME
, SMALL_BUSINESS_CODE
, CCR_COMMENTS
, DEBARMENT_START_DATE
, DEBARMENT_END_DATE
, ACK_LEAD_TIME
, BIW_INS_DTTM
, BIW_UPD_DTTM
, BIW_BATCH_ID
FROM {{source("STG_EBS_AP","AP_SUPPLIER_SITES_ALL")}}    
QUALIFY( ROW_NUMBER() OVER (PARTITION BY VENDOR_SITE_ID ORDER BY BIW_UPD_DTTM DESC)=1)