
 {{  config (   description = "S2P DATA DISCOVERY VIEW OF PO_LINES_ALL ", 
    materialized = "view",    
    schema = "PROCUREMENT",    
    tags = ["PROCUREMENT"],   
    alias = "PO_LINES_ALL" 
    )  
}} 
SELECT 
PO_LINE_ID 
, LAST_UPDATE_DATE
, LAST_UPDATED_BY
, PO_HEADER_ID
, LINE_TYPE_ID
, LINE_NUM
, LAST_UPDATE_LOGIN
, CREATION_DATE
, CREATED_BY
, ITEM_ID
, ITEM_REVISION
, CATEGORY_ID
, ITEM_DESCRIPTION
, UNIT_MEAS_LOOKUP_CODE
, QUANTITY_COMMITTED
, COMMITTED_AMOUNT
, ALLOW_PRICE_OVERRIDE_FLAG
, NOT_TO_EXCEED_PRICE
, LIST_PRICE_PER_UNIT
, UNIT_PRICE
, QUANTITY
, UN_NUMBER_ID
, HAZARD_CLASS_ID
, NOTE_TO_VENDOR
, FROM_HEADER_ID
, FROM_LINE_ID
, MIN_ORDER_QUANTITY
, MAX_ORDER_QUANTITY
, QTY_RCV_TOLERANCE
, OVER_TOLERANCE_ERROR_FLAG
, MARKET_PRICE
, UNORDERED_FLAG
, CLOSED_FLAG
, USER_HOLD_FLAG
, CANCEL_FLAG
, CANCELLED_BY
, CANCEL_DATE
, CANCEL_REASON
, FIRM_STATUS_LOOKUP_CODE
, FIRM_DATE
, VENDOR_PRODUCT_NUM
, CONTRACT_NUM
, TAXABLE_FLAG
, TAX_NAME
, TYPE_1099
, CAPITAL_EXPENSE_FLAG
, NEGOTIATED_BY_PREPARER_FLAG
, ATTRIBUTE_CATEGORY
, ATTRIBUTE1
, ATTRIBUTE2
, ATTRIBUTE3
, ATTRIBUTE4
, ATTRIBUTE5
, ATTRIBUTE6
, ATTRIBUTE7
, ATTRIBUTE8
, ATTRIBUTE9
, ATTRIBUTE10
, REFERENCE_NUM
, ATTRIBUTE11
, ATTRIBUTE12
, ATTRIBUTE13
, ATTRIBUTE14
, ATTRIBUTE15
, MIN_RELEASE_AMOUNT
, PRICE_TYPE_LOOKUP_CODE
, CLOSED_CODE
, PRICE_BREAK_LOOKUP_CODE
, USSGL_TRANSACTION_CODE
, GOVERNMENT_CONTEXT
, REQUEST_ID
, PROGRAM_APPLICATION_ID
, PROGRAM_ID
, PROGRAM_UPDATE_DATE
, CLOSED_DATE
, CLOSED_REASON
, CLOSED_BY
, TRANSACTION_REASON_CODE
, ORG_ID
, QC_GRADE
, BASE_UOM
, BASE_QTY
, SECONDARY_UOM
, SECONDARY_QTY
, GLOBAL_ATTRIBUTE_CATEGORY
, GLOBAL_ATTRIBUTE1
, GLOBAL_ATTRIBUTE2
, GLOBAL_ATTRIBUTE3
, GLOBAL_ATTRIBUTE4
, GLOBAL_ATTRIBUTE5
, GLOBAL_ATTRIBUTE6
, GLOBAL_ATTRIBUTE7
, GLOBAL_ATTRIBUTE8
, GLOBAL_ATTRIBUTE9
, GLOBAL_ATTRIBUTE10
, GLOBAL_ATTRIBUTE11
, GLOBAL_ATTRIBUTE12
, GLOBAL_ATTRIBUTE13
, GLOBAL_ATTRIBUTE14
, GLOBAL_ATTRIBUTE15
, GLOBAL_ATTRIBUTE16
, GLOBAL_ATTRIBUTE17
, GLOBAL_ATTRIBUTE18
, GLOBAL_ATTRIBUTE19
, GLOBAL_ATTRIBUTE20
, LINE_REFERENCE_NUM
, PROJECT_ID
, TASK_ID
, EXPIRATION_DATE
, TAX_CODE_ID
, OKE_CONTRACT_HEADER_ID
, OKE_CONTRACT_VERSION_ID
, SECONDARY_QUANTITY
, SECONDARY_UNIT_OF_MEASURE
, PREFERRED_GRADE
, AUCTION_HEADER_ID
, AUCTION_DISPLAY_NUMBER
, AUCTION_LINE_NUMBER
, BID_NUMBER
, BID_LINE_NUMBER
, RETROACTIVE_DATE
, FROM_LINE_LOCATION_ID
, SUPPLIER_REF_NUMBER
, CONTRACT_ID
, START_DATE
, AMOUNT
, JOB_ID
, CONTRACTOR_FIRST_NAME
, CONTRACTOR_LAST_NAME
, ORDER_TYPE_LOOKUP_CODE
, PURCHASE_BASIS
, MATCHING_BASIS
, SVC_AMOUNT_NOTIF_SENT
, SVC_COMPLETION_NOTIF_SENT
, BASE_UNIT_PRICE
, MANUAL_PRICE_CHANGE_FLAG
, RETAINAGE_RATE
, MAX_RETAINAGE_AMOUNT
, PROGRESS_PAYMENT_RATE
, RECOUPMENT_RATE
, CATALOG_NAME
, SUPPLIER_PART_AUXID
, IP_CATEGORY_ID
, TAX_ATTRIBUTE_UPDATE_CODE
, LAST_UPDATED_PROGRAM
, GROUP_LINE_ID
, LINE_NUM_DISPLAY
, CLM_INFO_FLAG
, CLM_OPTION_INDICATOR
, CLM_BASE_LINE_NUM
, CLM_OPTION_NUM
, CLM_OPTION_FROM_DATE
, CLM_OPTION_TO_DATE
, CLM_FUNDED_FLAG
, CONTRACT_TYPE
, COST_CONSTRAINT
, CLM_IDC_TYPE
, UDA_TEMPLATE_ID
, USER_DOCUMENT_STATUS
, DRAFT_ID
, CLM_EXERCISED_FLAG
, CLM_EXERCISED_DATE
, CLM_MIN_TOTAL_AMOUNT
, CLM_MAX_TOTAL_AMOUNT
, CLM_MIN_TOTAL_QUANTITY
, CLM_MAX_TOTAL_QUANTITY
, CLM_MIN_ORDER_AMOUNT
, CLM_MAX_ORDER_AMOUNT
, CLM_MIN_ORDER_QUANTITY
, CLM_MAX_ORDER_QUANTITY
, CLM_TOTAL_AMOUNT_ORDERED
, CLM_TOTAL_QUANTITY_ORDERED
, CLM_FSC_PSC
, CLM_MDAPS_MAIS
, CLM_NAICS
, CLM_ORDER_START_DATE
, CLM_ORDER_END_DATE
, REVISION_NUM
, CLM_APPROVED_UNDEF_AMOUNT
, CLM_DELIVERY_EVENT_CODE
, CLM_EXHIBIT_NAME
, CLM_PAYMENT_INSTR_CODE
, CLM_POP_EXCEPTION_REASON
, CLM_UDA_PRICING_TOTAL
, CLM_UNDEF_ACTION_CODE
, CLM_UNDEF_FLAG
, SCHEDULES_REQUIRED_FLAG
, CANCEL_REASON1
, BIW_INS_DTTM
, BIW_UPD_DTTM
, BIW_BATCH_ID
FROM {{source("STG_EBS_PO","PO_LINES_ALL")}}    
QUALIFY( ROW_NUMBER() OVER (PARTITION BY PO_LINE_ID ORDER BY BIW_UPD_DTTM DESC)=1)