{{ 
config
(
  description = 'E2open view for E2OPEN_WIP_INVENTORY table', 
  materialized = 'view', 
  schema = 'GSCO', 
  tags = ['E2OPEN'],
  alias = 'E2O_WIP_INVENTORY'
) 
}}

SELECT 
    LOT_NAME,
    MES_LOT_NAME,
    EXTERNAL_LOT_NAME,
    LOT_STATE,
    LOT_TYPE,
    LOT_COMMENT,
    MOST_RECENT_MOVE_TX_TIME,
    LAST_TX_TIME,
    LAST_TX_TYPE,
    GOOD_QTY1,
    REJECT_QTY1,
    UOM,
    GOOD_QTY2,
    NO_OF_POTENTIAL_GOODQTY2,
    REJECT_QTY2,
    UOM2,
    LOCATION_NAME,
    STAGE_SET_NAME,
    PARENT_STAGE_SET_NAME,
    MFG_REPORTING_STAGE_GROUP,
    INVENTORY_POINT_NAME,
    WIP_PROCESS_PLAN_NAME,
    WIP_PROCESS_PLAN_REV,
    WIP_PROCESS_PLAN_STEP_NAME,
    WIP_PROCESS_PLAN_STEP_MAJOR_REV,
    WIP_PROCESS_PLAN_STEP_MINOR_REV,
    WIP_IO_LINK_NAME,
    WIP_IO_LINK_MAJOR_VERSION,
    WIP_IO_LINK_MINOR_VERSION,
    PRODUCT_NAME,
    PRODUCT_TYPE,
    PRODUCT_REVISION,
    PRODUCT_DESCRIPTION,
    PRODUCT_GROUP_TYPE1,
    PRODUCT_GROUP1,
    PRODUCT_GROUP_TYPE2,
    PRODUCT_GROUP2,
    PACKAGE_TYPE,
    NUMBER_OF_LEADS,
    ALTERNATE_PART_NAME,
    FAB_LOCATION_NAME,
    COUNTRY_OF_FAB,
    FAB_IO_LINK_NAME,
    FAB_IO_LINK_MAJOR_VERSION,
    FAB_IO_LINK_MINOR_VERSION,
    FAB_AREA,
    FAB_TECHNOLOGY,
    FAB_PRODUCT_NAME,
    ASSEMBLY_LOCATION_NAME,
    ASSEMBLY_STAGE_SET_NAME,
    COUNTRY_OF_ASSEMBLY,
    ASSEMBLY_MATERIAL_BOM_NAME,
    ASSEMBLY_AREA,
    ASSEMBLY_IO_LINK_NAME,
    ASSEMBLY_IO_LINK_MAJOR_VERSION,
    ASSEMBLY_IO_LINK_MINOR_VERSION,
    ASSEMBLY_PRODUCT_NAME,
    ASSEMBLY_VERSION,
    TEST_LOCATION_NAME,
    TEST_STAGE_SET_NAME,
    COUNTRY_OF_TEST,
    TEST_AREA,
    TEST_IO_LINK_NAME,
    TEST_IO_LINK_MAJOR_VERSION,
    TEST_IO_LINK_MINOR_VERSION,
    TEST_PROGRAM,
    TEST_PROGRAM_REVISION,
    TEST_PRODUCT_NAME,
    FINAL_TEST_LOCATION_NAME,
    FINAL_TEST_STAGE_SET_NAME,
    FINAL_TEST_AREA,
    COUNTRY_OF_FINAL_TEST,
    FINAL_TEST_IO_LINK_NAME,
    FINAL_TEST_IO_LINK_MAJOR_VERSION,
    FINAL_TEST_IO_LINK_MINOR_VERSION,
    FINAL_TEST_PRODUCT_NAME,
    ROUTING_STATUS,
    BUOWNER,
    PRIORITY,
    REWORK_FLAG,
    HOLD_FLAG,
    BONUS_FLAG,
    RESTRICTED_FLAG,
    REJECT_FLAG,
    HOT_LOT_FLAG,
    SAMPLE_LOT_FLAG,
    MASK_SET,
    MASK_SET_REVISION,
    PROJECTED_OUT_DATE,
    SCHEDSTART_TIME,
    EXPIRATION_DATE,
    RMA_NUMBER,
    VALUATION_CATEGORY,
    SO_NUMBER,
    SO_ITEM_NUMBER,
    PURCHASE_ORDER,
    PURCHASE_ORDER_LINE_ITEM,
    CURRENT_IDV,
    ROOT_PARENT_LOT_NAME,
    ROOT_PARENT_MES_LOT_NAME,
    FROM_EXTERNAL_LOT_NAME,
    PLAN_PROJECTED_OUT_TIME,
    PLAN_PROJECTED_OUT_QTY1,
    PLAN_PROJECTED_OUT_QTY2,
    ORIG_PROJECTED_OUT_DATE,
    FAB_WAFER_QTY,
    PROJ_HOLD_RELEASE_DATE,
    PROJECTED_OUT_DATEWW,
    BIRTH_DATE,
    BIRTH_DATEWW,
    CUMULATIVE_LOT_INVOICE_AMT,
    CURRENT_ACTIVITY_BASED_COST,
    CURRENT_VALUATION,
    DIRECT_MATERIAL_COST,
    INDIRECT_COST,
    REWORK_COST,
    CURRENT_BIN_TYPE,
    CURRENT_BIN,
    PARENT_BIN_NAME,
    RETURN_NAME,
    MES_INSTANCE,
    MES_USER_NAME,
    ASSEMBLY_DATE_CODE,
    ASSEMBLY_LOT_NAME,
    BUMP_LOCATION_NAME,
    BURN_IN_TEMP,
    FAB_DATE_CODE,
    MARKING_CODE,
    MARKING_SPEC,
    SCREEN_FLOW_CODE,
    SHELF_BIN,
    SHELF_ISLE,
    SHELF_ROW,
    SL1_TEST_PROGRAM,
    SL2_TEST_PROGRAM,
    SPECIAL_MARK,
    TEST_CODE,
    TEST_PROGRAM_EXEC_CODE,
    TEST_PROGRAM_EXEC_NAME,
    TEST_PROGRAM_EXE_CREV,
    GEN_CHAR01,
    GEN_CHAR02,
    GEN_CHAR03,
    GEN_CHAR04,
    GEN_CHAR05,
    GEN_CHAR06,
    GEN_CHAR07,
    GEN_CHAR08,
    GEN_CHAR09,
    GEN_CHAR10,
    GEN_CHAR11,
    GEN_CHAR12,
    GEN_CHAR13,
    GEN_CHAR14,
    GEN_CHAR15,
    GEN_CHAR16,
    GEN_CHAR17,
    GEN_CHAR18,
    GEN_CHAR19,
    GEN_CHAR20,
    GEN_CHAR21,
    GEN_CHAR22,
    GEN_CHAR23,
    GEN_CHAR24,
    GEN_CHAR25,
    GEN_CHAR26,
    GEN_CHAR27,
    GEN_CHAR28,
    GEN_CHAR29,
    GEN_CHAR30,
    GEN_CHAR31,
    GEN_CHAR32,
    GEN_CHAR33,
    GEN_CHAR35,
    GEN_INT01,
    GEN_INT02,
    GEN_FLOAT01,
    ASSEMBLY_DATE_TIME,
    ASSEMBLY_START_TIME,
    FAB_COMPLETE_TIME,
    FAB_DATE_TIME,
    GEN_DATE01,
    GEN_DATE02,
    GEN_DATE03,
    GEN_DATE04,
    GEN_DATE05,
    GEN_DATE06,
    GEN_DATE07,
    GEN_DATE08,
    GEN_DATE09,
    GEN_DATE10,
    MARK_FLAG,
    MAVERICK_FLAG,
    GEN_FLAG01,
    LOCATION_DIVISION,
    LOTS_TAGESETSEMIFG_FLAG,
    BIW_INS_DTTM,
    BIW_UPD_DTTM,
    BIW_BATCH_ID,
    FILE_NAME
FROM 
{{source('STG_E2OPEN','STG_WIP_INVENTORY')}}
WHERE BIW_BATCH_ID = (SELECT MAX(BIW_BATCH_ID) FROM {{source('STG_E2OPEN','STG_WIP_INVENTORY')}})