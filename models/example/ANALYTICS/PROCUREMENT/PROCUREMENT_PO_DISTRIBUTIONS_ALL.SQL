
 {{  config (   
     description = "S2P DATA DISCOVERY VIEW OF PO_DISTRIBUTIONS_ALL ",    
     materialized = "view",    
     schema = "PROCUREMENT",    
     tags = ["PROCUREMENT"],   
     alias = "PO_DISTRIBUTIONS_ALL" 
     )  
     }} 
     
SELECT 
PO_DISTRIBUTION_ID 
, LAST_UPDATE_DATE
, LAST_UPDATED_BY
, PO_HEADER_ID
, PO_LINE_ID
, LINE_LOCATION_ID
, SET_OF_BOOKS_ID
, CODE_COMBINATION_ID
, QUANTITY_ORDERED
, LAST_UPDATE_LOGIN
, CREATION_DATE
, CREATED_BY
, PO_RELEASE_ID
, QUANTITY_DELIVERED
, QUANTITY_BILLED
, QUANTITY_CANCELLED
, REQ_HEADER_REFERENCE_NUM
, REQ_LINE_REFERENCE_NUM
, REQ_DISTRIBUTION_ID
, DELIVER_TO_LOCATION_ID
, DELIVER_TO_PERSON_ID
, RATE_DATE
, RATE
, AMOUNT_BILLED
, ACCRUED_FLAG
, ENCUMBERED_FLAG
, ENCUMBERED_AMOUNT
, UNENCUMBERED_QUANTITY
, UNENCUMBERED_AMOUNT
, FAILED_FUNDS_LOOKUP_CODE
, GL_ENCUMBERED_DATE
, GL_ENCUMBERED_PERIOD_NAME
, GL_CANCELLED_DATE
, DESTINATION_TYPE_CODE
, DESTINATION_ORGANIZATION_ID
, DESTINATION_SUBINVENTORY
, ATTRIBUTE_CATEGORY
, ATTRIBUTE1
, ATTRIBUTE2
, ATTRIBUTE3
, ATTRIBUTE4
, ATTRIBUTE5
, ATTRIBUTE6
, ATTRIBUTE7
, ATTRIBUTE8
, ATTRIBUTE9
, ATTRIBUTE10
, ATTRIBUTE11
, ATTRIBUTE12
, ATTRIBUTE13
, ATTRIBUTE14
, ATTRIBUTE15
, WIP_ENTITY_ID
, WIP_OPERATION_SEQ_NUM
, WIP_RESOURCE_SEQ_NUM
, WIP_REPETITIVE_SCHEDULE_ID
, WIP_LINE_ID
, BOM_RESOURCE_ID
, BUDGET_ACCOUNT_ID
, ACCRUAL_ACCOUNT_ID
, VARIANCE_ACCOUNT_ID
, PREVENT_ENCUMBRANCE_FLAG
, USSGL_TRANSACTION_CODE
, GOVERNMENT_CONTEXT
, DESTINATION_CONTEXT
, DISTRIBUTION_NUM
, SOURCE_DISTRIBUTION_ID
, REQUEST_ID
, PROGRAM_APPLICATION_ID
, PROGRAM_ID
, PROGRAM_UPDATE_DATE
, PROJECT_ID
, TASK_ID
, EXPENDITURE_TYPE
, PROJECT_ACCOUNTING_CONTEXT
, EXPENDITURE_ORGANIZATION_ID
, GL_CLOSED_DATE
, ACCRUE_ON_RECEIPT_FLAG
, EXPENDITURE_ITEM_DATE
, ORG_ID
, KANBAN_CARD_ID
, AWARD_ID
, MRC_RATE_DATE
, MRC_RATE
, MRC_ENCUMBERED_AMOUNT
, MRC_UNENCUMBERED_AMOUNT
, END_ITEM_UNIT_NUMBER
, TAX_RECOVERY_OVERRIDE_FLAG
, RECOVERABLE_TAX
, NONRECOVERABLE_TAX
, RECOVERY_RATE
, OKE_CONTRACT_LINE_ID
, OKE_CONTRACT_DELIVERABLE_ID
, AMOUNT_ORDERED
, AMOUNT_DELIVERED
, AMOUNT_CANCELLED
, DISTRIBUTION_TYPE
, AMOUNT_TO_ENCUMBER
, INVOICE_ADJUSTMENT_FLAG
, DEST_CHARGE_ACCOUNT_ID
, DEST_VARIANCE_ACCOUNT_ID
, QUANTITY_FINANCED
, AMOUNT_FINANCED
, QUANTITY_RECOUPED
, AMOUNT_RECOUPED
, RETAINAGE_WITHHELD_AMOUNT
, RETAINAGE_RELEASED_AMOUNT
, WF_ITEM_KEY
, INVOICED_VAL_IN_NTFN
, TAX_ATTRIBUTE_UPDATE_CODE
, INTERFACE_DISTRIBUTION_REF
, LCM_FLAG
, GROUP_LINE_ID
, UDA_TEMPLATE_ID
, DRAFT_ID
, AMOUNT_FUNDED
, FUNDED_VALUE
, PARTIAL_FUNDED_FLAG
, QUANTITY_FUNDED
, CLM_MISC_LOA
, CLM_DEFENCE_FUNDING
, CLM_FMS_CASE_NUMBER
, CLM_AGENCY_ACCT_IDENTIFIER
, CHANGE_IN_FUNDED_VALUE
, ACRN
, REVISION_NUM
, CLM_PAYMENT_SEQUENCE_NUM
, AMOUNT_CHANGED_FLAG
, GLOBAL_ATTRIBUTE_CATEGORY
, GLOBAL_ATTRIBUTE1
, GLOBAL_ATTRIBUTE2
, GLOBAL_ATTRIBUTE3
, GLOBAL_ATTRIBUTE4
, GLOBAL_ATTRIBUTE5
, GLOBAL_ATTRIBUTE6
, GLOBAL_ATTRIBUTE7
, GLOBAL_ATTRIBUTE8
, GLOBAL_ATTRIBUTE9
, GLOBAL_ATTRIBUTE10
, GLOBAL_ATTRIBUTE11
, GLOBAL_ATTRIBUTE12
, GLOBAL_ATTRIBUTE13
, GLOBAL_ATTRIBUTE14
, GLOBAL_ATTRIBUTE15
, GLOBAL_ATTRIBUTE16
, GLOBAL_ATTRIBUTE17
, GLOBAL_ATTRIBUTE18
, GLOBAL_ATTRIBUTE19
, GLOBAL_ATTRIBUTE20
, AMOUNT_REVERSED
, BIW_INS_DTTM
, BIW_UPD_DTTM
, BIW_BATCH_ID
FROM {{source("STG_EBS_PO","PO_DISTRIBUTIONS_ALL")}}     
QUALIFY( ROW_NUMBER() OVER (PARTITION BY PO_DISTRIBUTION_ID ORDER BY BIW_UPD_DTTM DESC)=1)