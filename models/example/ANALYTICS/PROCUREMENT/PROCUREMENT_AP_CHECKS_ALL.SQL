{{  config (  
     description = "S2P DATA DISCOVERY VIEW OF AP_CHECKS_ALL ",    
     materialized = "view",    
     schema = "PROCUREMENT",    
     tags = ["PROCUREMENT"],  
      alias = "AP_CHECKS_ALL" )  }}

SELECT 
    AMOUNT 
    , BANK_ACCOUNT_ID
    , BANK_ACCOUNT_NAME
    , CHECK_DATE
    , CHECK_ID
    , CHECK_NUMBER
    , CURRENCY_CODE
    , LAST_UPDATED_BY
    , LAST_UPDATE_DATE
    , PAYMENT_METHOD_LOOKUP_CODE
    , PAYMENT_TYPE_FLAG
    , ADDRESS_LINE1
    , ADDRESS_LINE2
    , ADDRESS_LINE3
    , CHECKRUN_NAME
    , CHECK_FORMAT_ID
    , CHECK_STOCK_ID
    , CITY
    , COUNTRY
    , CREATED_BY
    , CREATION_DATE
    , LAST_UPDATE_LOGIN
    , STATUS_LOOKUP_CODE
    , VENDOR_NAME
    , VENDOR_SITE_CODE
    , ZIP
    , BANK_ACCOUNT_NUM
    , BANK_ACCOUNT_TYPE
    , BANK_NUM
    , CHECK_VOUCHER_NUM
    , CLEARED_AMOUNT
    , CLEARED_DATE
    , DOC_CATEGORY_CODE
    , DOC_SEQUENCE_ID
    , DOC_SEQUENCE_VALUE
    , PROVINCE
    , RELEASED_AT
    , RELEASED_BY
    , STATE
    , STOPPED_AT
    , STOPPED_BY
    , VOID_DATE
    , ATTRIBUTE1
    , ATTRIBUTE10
    , ATTRIBUTE11
    , ATTRIBUTE12
    , ATTRIBUTE13
    , ATTRIBUTE14
    , ATTRIBUTE15
    , ATTRIBUTE2
    , ATTRIBUTE3
    , ATTRIBUTE4
    , ATTRIBUTE5
    , ATTRIBUTE6
    , ATTRIBUTE7
    , ATTRIBUTE8
    , ATTRIBUTE9
    , ATTRIBUTE_CATEGORY
    , FUTURE_PAY_DUE_DATE
    , TREASURY_PAY_DATE
    , TREASURY_PAY_NUMBER
    , USSGL_TRANSACTION_CODE
    , USSGL_TRX_CODE_CONTEXT
    , WITHHOLDING_STATUS_LOOKUP_CODE
    , RECONCILIATION_BATCH_ID
    , CLEARED_BASE_AMOUNT
    , CLEARED_EXCHANGE_RATE
    , CLEARED_EXCHANGE_DATE
    , CLEARED_EXCHANGE_RATE_TYPE
    , ADDRESS_LINE4
    , COUNTY
    , ADDRESS_STYLE
    , ORG_ID
    , VENDOR_ID
    , VENDOR_SITE_ID
    , EXCHANGE_RATE
    , EXCHANGE_DATE
    , EXCHANGE_RATE_TYPE
    , BASE_AMOUNT
    , CHECKRUN_ID
    , REQUEST_ID
    , CLEARED_ERROR_AMOUNT
    , CLEARED_CHARGES_AMOUNT
    , CLEARED_ERROR_BASE_AMOUNT
    , CLEARED_CHARGES_BASE_AMOUNT
    , POSITIVE_PAY_STATUS_CODE
    , GLOBAL_ATTRIBUTE_CATEGORY
    , GLOBAL_ATTRIBUTE1
    , GLOBAL_ATTRIBUTE2
    , GLOBAL_ATTRIBUTE3
    , GLOBAL_ATTRIBUTE4
    , GLOBAL_ATTRIBUTE5
    , GLOBAL_ATTRIBUTE6
    , GLOBAL_ATTRIBUTE7
    , GLOBAL_ATTRIBUTE8
    , GLOBAL_ATTRIBUTE9
    , GLOBAL_ATTRIBUTE10
    , GLOBAL_ATTRIBUTE11
    , GLOBAL_ATTRIBUTE12
    , GLOBAL_ATTRIBUTE13
    , GLOBAL_ATTRIBUTE14
    , GLOBAL_ATTRIBUTE15
    , GLOBAL_ATTRIBUTE16
    , GLOBAL_ATTRIBUTE17
    , GLOBAL_ATTRIBUTE18
    , GLOBAL_ATTRIBUTE19
    , GLOBAL_ATTRIBUTE20
    , TRANSFER_PRIORITY
    , EXTERNAL_BANK_ACCOUNT_ID
    , STAMP_DUTY_AMT
    , STAMP_DUTY_BASE_AMT
    , MRC_CLEARED_BASE_AMOUNT
    , MRC_CLEARED_EXCHANGE_RATE
    , MRC_CLEARED_EXCHANGE_DATE
    , MRC_CLEARED_EXCHANGE_RATE_TYPE
    , MRC_EXCHANGE_RATE
    , MRC_EXCHANGE_DATE
    , MRC_EXCHANGE_RATE_TYPE
    , MRC_BASE_AMOUNT
    , MRC_CLEARED_ERROR_BASE_AMOUNT
    , MRC_CLEARED_CHARGES_BASE_AMT
    , MRC_STAMP_DUTY_BASE_AMT
    , MATURITY_EXCHANGE_DATE
    , MATURITY_EXCHANGE_RATE_TYPE
    , MATURITY_EXCHANGE_RATE
    , DESCRIPTION
    , ACTUAL_VALUE_DATE
    , ANTICIPATED_VALUE_DATE
    , RELEASED_DATE
    , STOPPED_DATE
    , MRC_MATURITY_EXG_DATE
    , MRC_MATURITY_EXG_RATE
    , MRC_MATURITY_EXG_RATE_TYPE
    , IBAN_NUMBER
    , CE_BANK_ACCT_USE_ID
    , PAYMENT_METHOD_CODE
    , PARTY_ID
    , PARTY_SITE_ID
    , PAYMENT_PROFILE_ID
    , SETTLEMENT_PRIORITY
    , BANK_CHARGE_BEARER
    , LEGAL_ENTITY_ID
    , PAYMENT_DOCUMENT_ID
    , COMPLETED_PMTS_GROUP_ID
    , PAYMENT_ID
    , PAYMENT_INSTRUCTION_ID
    , VOID_CHECK_NUMBER
    , VOID_CHECK_ID
    , REMIT_TO_SUPPLIER_NAME
    , REMIT_TO_SUPPLIER_ID
    , REMIT_TO_SUPPLIER_SITE
    , REMIT_TO_SUPPLIER_SITE_ID
    , RELATIONSHIP_ID
    , PAYCARD_AUTHORIZATION_NUMBER
    , PAYCARD_REFERENCE_ID
    , ACKNOWLEDGED_FLAG
    , BIW_INS_DTTM
    , BIW_UPD_DTTM
    , BIW_BATCH_ID
FROM {{source("STG_EBS_APPS","AP_CHECKS_ALL")}}    
QUALIFY( ROW_NUMBER() OVER (PARTITION BY CHECK_ID ORDER BY BIW_UPD_DTTM DESC)=1)