
 {{  config (   
     description = "S2P DATA DISCOVERY VIEW OF AP_INVOICE_PAYMENTS_ALL ",    
     materialized = "view",    
     schema = "PROCUREMENT",    
     tags = ["PROCUREMENT"],   
     alias = "AP_INVOICE_PAYMENTS_ALL" 
     ) 
    }} 

SELECT ACCOUNTING_EVENT_ID 
, ACCOUNTING_DATE
, ACCRUAL_POSTED_FLAG
, AMOUNT
, CASH_POSTED_FLAG
, CHECK_ID
, INVOICE_ID
, INVOICE_PAYMENT_ID
, LAST_UPDATED_BY
, LAST_UPDATE_DATE
, PAYMENT_NUM
, PERIOD_NAME
, POSTED_FLAG
, SET_OF_BOOKS_ID
, ACCTS_PAY_CODE_COMBINATION_ID
, ASSET_CODE_COMBINATION_ID
, CREATED_BY
, CREATION_DATE
, LAST_UPDATE_LOGIN
, BANK_ACCOUNT_NUM
, BANK_ACCOUNT_TYPE
, BANK_NUM
, DISCOUNT_LOST
, DISCOUNT_TAKEN
, EXCHANGE_DATE
, EXCHANGE_RATE
, EXCHANGE_RATE_TYPE
, GAIN_CODE_COMBINATION_ID
, INVOICE_BASE_AMOUNT
, LOSS_CODE_COMBINATION_ID
, PAYMENT_BASE_AMOUNT
, ATTRIBUTE1
, ATTRIBUTE10
, ATTRIBUTE11
, ATTRIBUTE12
, ATTRIBUTE13
, ATTRIBUTE14
, ATTRIBUTE15
, ATTRIBUTE2
, ATTRIBUTE3
, ATTRIBUTE4
, ATTRIBUTE5
, ATTRIBUTE6
, ATTRIBUTE7
, ATTRIBUTE8
, ATTRIBUTE9
, ATTRIBUTE_CATEGORY
, CASH_JE_BATCH_ID
, FUTURE_PAY_CODE_COMBINATION_ID
, FUTURE_PAY_POSTED_FLAG
, JE_BATCH_ID
, ELECTRONIC_TRANSFER_ID
, ASSETS_ADDITION_FLAG
, INVOICE_PAYMENT_TYPE
, OTHER_INVOICE_ID
, ORG_ID
, GLOBAL_ATTRIBUTE_CATEGORY
, GLOBAL_ATTRIBUTE1
, GLOBAL_ATTRIBUTE2
, GLOBAL_ATTRIBUTE3
, GLOBAL_ATTRIBUTE4
, GLOBAL_ATTRIBUTE5
, GLOBAL_ATTRIBUTE6
, GLOBAL_ATTRIBUTE7
, GLOBAL_ATTRIBUTE8
, GLOBAL_ATTRIBUTE9
, GLOBAL_ATTRIBUTE10
, GLOBAL_ATTRIBUTE11
, GLOBAL_ATTRIBUTE12
, GLOBAL_ATTRIBUTE13
, GLOBAL_ATTRIBUTE14
, GLOBAL_ATTRIBUTE15
, GLOBAL_ATTRIBUTE16
, GLOBAL_ATTRIBUTE17
, GLOBAL_ATTRIBUTE18
, GLOBAL_ATTRIBUTE19
, GLOBAL_ATTRIBUTE20
, EXTERNAL_BANK_ACCOUNT_ID
, MRC_EXCHANGE_DATE
, MRC_EXCHANGE_RATE
, MRC_EXCHANGE_RATE_TYPE
, MRC_GAIN_CODE_COMBINATION_ID
, MRC_INVOICE_BASE_AMOUNT
, MRC_LOSS_CODE_COMBINATION_ID
, MRC_PAYMENT_BASE_AMOUNT
, REVERSAL_FLAG
, REVERSAL_INV_PMT_ID
, IBAN_NUMBER
, INVOICING_PARTY_ID
, INVOICING_PARTY_SITE_ID
, INVOICING_VENDOR_SITE_ID
, REMIT_TO_SUPPLIER_NAME
, REMIT_TO_SUPPLIER_ID
, REMIT_TO_SUPPLIER_SITE
, REMIT_TO_SUPPLIER_SITE_ID
, BIW_INS_DTTM
, BIW_UPD_DTTM
, BIW_BATCH_ID
FROM {{source("STG_EBS_AP","AP_INVOICE_PAYMENTS_ALL")}}    
QUALIFY( ROW_NUMBER() OVER (PARTITION BY INVOICE_PAYMENT_ID ORDER BY BIW_UPD_DTTM DESC)=1)