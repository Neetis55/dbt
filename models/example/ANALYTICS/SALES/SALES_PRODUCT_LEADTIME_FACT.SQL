{{ config(
  description = 'PRODUCT_LEADTIME_FACT view for Sales Analytics Team', 
  materialized = 'view', 
  schema = 'SALES', 
  tags = 'MART_SALES',
  alias = 'PRODUCT_LEADTIME_FACT'
) }} 

SELECT
    FACT.PRODUCT_LEADTIME_KEY,
    FACT.INTERNAL_PART_NUMBER_KEY,
    FACT.FISCAL_WEEK_KEY,
    FACT.INTERNAL_PART_NUMBER,
    FACT.MASTER_PLANNING_RUN_DATE,    
    FACT.BACKLOG_QUANTITY,
    BRIDGE.BUCKET_SEQUENCE,
    FACT.CAPACITY_CONSTRAINT_COLOR,
    FACT.CYCLETIME_PLUS_WEEKS_LEADTIME,
    FACT.DCE_CD,
    FACT.DCE_CYCLETIME,
    FACT.FAMILY_LEADTIME,
    FACT.FLOOR_OVERRIDE_DATE,
    FACT.FLOOR_OVERRIDE_LEADTIME,
    FACT.FLOOR_OVERRIDE_USERID,
    FACT.LEADTIME_OVERRIDE_LEVEL,
    FACT.OPT_01_LEADTIME,
    FACT.OPT_01_SIMULATED_LEADTIME,
    FACT.OPT_02_LEADTIME,
    FACT.OPT_02_SIMULATED_LEADTIME,
    FACT.OPT_03_LEADTIME,
    FACT.OPT_03_SIMULATED_LEADTIME,
    FACT.OPT_04_LEADTIME,
    FACT.OPT_04_SIMULATED_LEADTIME,
    FACT.OPT_05_LEADTIME,
    FACT.OPT_05_SIMULATED_LEADTIME,
    FACT.OPT_06_LEADTIME,
    FACT.OPT_06_SIMULATED_LEADTIME,
    FACT.OPT_07_LEADTIME,
    FACT.OPT_07_SIMULATED_LEADTIME,
    FACT.OPT_08_LEADTIME,
    FACT.OPT_08_SIMULATED_LEADTIME,
    FACT.OVERRIDE_REASON_CODE,
    FACT.OVERRIDE_REASON_DESCRIPTION,
    FACT.OVRRIDE_LEADTIME,
    FACT.PART_STATUS_CODE,
    FACT.PERCENTAGE_LEADTIME,
    FACT.PACKAGE_GROUP,
    FACT.POINT_LEADTIME,
    FACT.PREVIOUS_TRANSACTION_BASED_ORDER_TRACKING_LEADTIME,
    FACT.REGULAR_OVERRIDE_DATE,
    FACT.REGULAR_OVERRIDE_REQUESTING_USERID,
    FACT.REGULAR_OVERRIDE_TO_DATE,
    FACT.REGULAR_OVERRIDE_USERID,
    FACT.TRANSACTION_BASED_ORDER_TRACKING_LEADTIME,
    FACT.TOP_PERFORMING_MEASURE_NAME,
    FACT.TOP_PERFORMING_MEASURE_VALUE,
    FACT.TOP_PERFORMING_MEASURE_VALUE_REFINED,
    FACT.TREND_LEADTIME,
    FACT.SOURCE_UPDATE_DATE,
    FACT.WEIGHTED_GAP_LEADTIME,
    FACT.BIW_INS_DTTM ,
    FACT.BIW_UPD_DTTM ,
    FACT.BIW_BATCH_ID,
    FACT.BIW_MD5_KEY
FROM {{ref('MART_SALES_PRODUCT_LEADTIME_FACT')}} FACT
INNER JOIN {{ref('MART_SALES_PRODUCT_LEADTIME_BUCKET_BRIDGE')}} BRIDGE
  ON FACT.MASTER_PLANNING_RUN_DATE=BRIDGE.MASTER_PLANNING_RUN_DATE
